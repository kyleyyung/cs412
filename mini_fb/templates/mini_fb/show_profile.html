<!--mini_fb/templates/mini_fb/show_all.html -->

{% extends 'mini_fb/base.html' %}

{% block content %}

<h1>Mini Facebook</h1>

<!-- print out the context variable called profiles -->

<main class="mini_grid-container">
    <div class="profile">
        <img src="{{profile.image_url}}" alt="{{profile.image_url}}"> <!--display the profiles image-->
        <h3>{{profile.first_name}} {{profile.last_name}}</h3> <!-- displays their first and last name-->
        <p>{{profile.city}}</p> <!--displays their home city-->
        <p>{{profile.email}} </p> <!-- displays their email address-->
        <button><a href="{% url 'update_profile' profile.pk %}">Update Profile</a></button>
    </div>

    <!--display the comments-->
    <div>
        <h2>Status Messages</h2>
        <!-- creates a button to redirec the user to the create status form-->
        <button><a href="{% url 'create_status' profile.pk %}">Add Message</a></button>
        <!--call the Profiles's get_status() method-->
        {% if profile.get_status_messages %}
            {% for status in profile.get_status_messages %}
            <table class="sm">
                <td>
                    <!-- check if there are any images-->
                    {% if status.get_images %}
                        <!-- display status images images-->
                        {% for img in status.get_images %}
                            <img src='{{img.image_file.url}}' alt='{{img.image_file.url}}'>
                        {% endfor %}
                    <!-- if there isn't-->
                    {% else %}
                    <!--display default avatar-->
                        <img src='https://wooster.edu/wp-content/uploads/2021/06/Headshot_Placeholder_3-1-500x500.png' alt='Default Avatar'>
                    {% endif %}
                </td>
                <td>
                    <table>
                        <tr>
                            <!-- display the message and the time it was sent-->
                            <p>{{ status.timestamp }}</p>
                            <p>{{ status.message }}</p>
                        </tr>
                        <tr>
                            <!-- display the update and delete message buttons-->
                            <button class="mini_button"><a href="{% url 'update_status' status.pk %}">Update</a></button>
                            <button class="mini_button"><a href="{% url 'delete_status' status.pk %}">Delete</a></button>
                        </tr>
                    </table>
                </td>
            </table>
            <!-- end for loop-->
            {% endfor %}
        {% else %}
        <div>
            <!-- if no status messages, say so-->
            <p>No Status Messages.</p>
        </div>
        {% endif %}
    </div>
</main>

{% endblock %}
